(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[684],{5379:function(e,t,l){Promise.resolve().then(l.bind(l,4059))},4059:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return p}});var s=l(7437),r=l(2265),n=l(6230);let a=()=>{let{handleOpen:e}=(0,r.useContext)(n.t);return(0,s.jsx)("div",{onClick:e,className:"bg-blue-700 hover:bg-blue-500 w-12 h-12 rounded-full flex justify-center items-center hover:cursor-pointer absolute right-10 bottom-10",children:(0,s.jsx)("p",{className:"font-bold text-white",children:"+"})})};var i=l(8626),c=l(4033),o=l(1865),u=l(4225),d=l(6450);let x=e=>{let{handleClose:t}=e,{modalType:l,setModalType:a,inputs:i}=(0,r.useContext)(n.t),x=(0,c.useRouter)(),{addArticle:h,updateArticle:m}=(0,r.useContext)(u.ArticlesContext),{register:f,handleSubmit:b,setValue:j,watch:p,formState:{errors:w}}=(0,o.cI)(),v=(0,r.useCallback)(async e=>{try{let l=await (0,d.r)("http://localhost:3001/articles","POST",{...e,createDateTime:new Date});if((null==l?void 0:l.statusCode)===401){localStorage.removeItem("accessToken"),x.push("/admin");return}if(null==l?void 0:l.error)return;h(l),t()}catch(e){console.warn(e)}},[h,t,x]),C=(0,r.useCallback)(async e=>{try{let l=await (0,d.r)("http://localhost:3001/articles/".concat(i.id),"PATCH",{...e,createDateTime:new Date});if((null==l?void 0:l.statusCode)===401){localStorage.removeItem("accessToken"),x.push("/admin");return}if(null==l?void 0:l.error)return;m(i.id,l),t()}catch(e){console.warn(e)}},[t,null==i?void 0:i.id,x,m]);(0,r.useEffect)(()=>{"edit"===l&&(j("title",null==i?void 0:i.values.title),j("description",null==i?void 0:i.values.description))},[l]);let N="add"===l?"Add new article":"Edit article",g="add"===l?v:C;return(0,s.jsx)("form",{onSubmit:b(g),className:"w-full max-w-md rounded-md bg-slate-300",children:(0,s.jsxs)("div",{className:"flex flex-col p-8",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("h2",{className:"font-bold center mb-4",children:N})}),(0,s.jsxs)("label",{htmlFor:"title",className:"mb-8 relative flex flex-col",children:[(0,s.jsx)("input",{...f("title",{required:!0}),placeholder:"Please enter title",className:"rounded-md w-full p-2"}),w.title&&(0,s.jsx)("span",{className:"text-red-700 text-xs absolute top-12",children:"This title field is required"})]}),(0,s.jsxs)("label",{htmlFor:"description",className:"mb-8 relative flex flex-col",children:[(0,s.jsx)("textarea",{placeholder:"Please enter description",...f("description",{required:!0}),className:"rounded-md w-full p-2 mb-2"}),w.description&&(0,s.jsx)("span",{className:"text-red-700 text-xs absolute -bottom-6",children:"This description field is required"})]}),(0,s.jsx)("input",{type:"submit",value:"Publish",className:"w-full bg-blue-700 p-2 rounded-md text-white hover:cursor-pointer hover:bg-blue-500"})]})})},h=()=>{let{open:e,handleClose:t}=(0,r.useContext)(n.t);return(0,s.jsx)(i.Z,{open:e,onClose:t,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,s.jsx)(x,{handleClose:t})})};var m=l(5162),f=l(5634),b=l(1396),j=l.n(b);function p(){let e=(0,c.useRouter)(),{open:t,handleOpen:l,handleClose:i}=(0,r.useContext)(n.t);return(0,r.useEffect)(()=>{localStorage.getItem("accessToken")||(0,c.redirect)("/")},[]),(0,s.jsxs)("div",{children:[(0,s.jsx)(f.h,{children:(0,s.jsxs)("div",{className:"flex w-full justify-between",children:[(0,s.jsx)(j(),{href:"/",className:"font-bold text-white",children:"Article Manager"}),(0,s.jsx)("h2",{className:"text-white font-extrabold ",children:"Welcome to Admin article board"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("accessToken"),e.push("/")},className:"text-white hover:text-blue-600",children:"Log out"})]})}),(0,s.jsx)(n.n,{children:(0,s.jsxs)(u.ArticlesContextProvider,{children:[(0,s.jsx)(m.q,{}),(0,s.jsx)(a,{}),(0,s.jsx)(h,{})]})})]})}},5162:function(e,t,l){"use strict";l.d(t,{q:function(){return b}});var s=l(7437),r=l(2265),n=l(4225),a=l(6446),i=l(6521),c=l(4033),o=l(6230),u=l(6450);let d=e=>{let t=new Date(e),l=t.getDate();return t.getMonth()+"-"+l+"-"+t.getFullYear()},x=e=>{let{article:t}=e,{title:l,description:x,createDateTime:h}=t,{deleteArticle:m,articles:f}=(0,r.useContext)(n.ArticlesContext),{open:b,setOpen:j,setModalType:p,setInputs:w}=(0,r.useContext)(o.t),v=(0,c.usePathname)(),C=(0,r.useMemo)(()=>v.includes("admin"),[v]),N=(e,t)=>{p("edit"),w(e,t),j(!0)},g=async e=>{try{await (0,u.r)("http://localhost:3001/articles/".concat(e),"DELETE"),m(e)}catch(e){console.warn(e)}};return(0,s.jsxs)("div",{className:"bg-white rounded-md drop-shadow-md p-6 w-full max-w-sm flex flex-col",children:[(0,s.jsx)("h3",{className:"font-bold text-xl text-[#242424]",children:t.title}),(0,s.jsx)("p",{className:"text-base text-[#6b6b6b]",children:t.description}),(0,s.jsxs)("div",{className:"mt-auto",children:[C&&(0,s.jsxs)("div",{className:"my-2 justify-between flex",children:[(0,s.jsx)(i.Z,{onClick:()=>N(t.id,{title:l,description:x}),className:"hover:cursor-pointer"}),(0,s.jsx)(a.Z,{onClick:()=>g(t.id),className:"hover:cursor-pointer"})]}),(0,s.jsx)("span",{className:"inline-flex text-slate-400 text-xs",children:d(h)})]})]})};var h=l(4211);let m=()=>{let{setSearchString:e,articles:t,setStoredArticles:l}=(0,r.useContext)(n.ArticlesContext),a=s=>{s.length>=3&&e(s),s||l(t)};return(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),console.log("submit")},className:"grid w-full max-w-4xl  bg-white rounded-md p-2 shadow-md  flex-1 md:flex-initial",children:(0,s.jsx)("input",{placeholder:"Search",className:" outline-none p-2 w-full",type:"text",onChange:e=>a(e.target.value)})})},f=()=>{let{sortArticleByDate:e}=(0,r.useContext)(n.ArticlesContext);return(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl flex",children:[(0,s.jsx)(m,{}),(0,s.jsx)(h.Z,{onClick:e,variant:"outlined",style:{width:200,marginLeft:15},children:"Sort by Date"})]})})},b=()=>{let{storedArticles:e,loading:t,searchString:l,searchArticle:a}=(0,r.useContext)(n.ArticlesContext),i=(0,c.usePathname)(),o=(0,r.useMemo)(()=>i.includes("admin"),[i]);return(0,r.useEffect)(()=>{l&&a(l)},[l]),(0,s.jsxs)("div",{className:"mt-6",children:[e.length>0&&(0,s.jsx)(f,{}),(0,s.jsxs)("div",{className:"flex justify-center",children:[t&&(0,s.jsx)("h2",{children:"Loading......."}),o?(0,s.jsx)("h4",{children:"Click plus button to add your first article"}):(0,s.jsx)("h2",{className:"flex justify-center",children:"There is no article to show"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4 w-full max-w-4xl py-6",children:e&&e.map(e=>(0,s.jsx)(x,{article:e},e.id))})]})]})}},5634:function(e,t,l){"use strict";l.d(t,{h:function(){return r}});var s=l(7437);let r=e=>{let{children:t}=e;return(0,s.jsx)("header",{className:"bg-slate-400 px-6 flex justify-between p-6",children:t})}},4225:function(e,t,l){"use strict";l.r(t),l.d(t,{ArticlesContext:function(){return c},ArticlesContextProvider:function(){return o}});var s=l(7437),r=l(2265),n=l(6450);let a=()=>{let[e,t]=(0,r.useState)([]),[l,s]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{s(!0),async function(){try{let e=await (0,n.r)("http://localhost:3001/articles","GET");e&&t(e)}catch(e){console.warn(e)}s(!1)}()},[]),{articles:e,loading:l,setArticles:t}},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"newest";return e.sort((e,l)=>"newest"===t?Number(new Date(l.createDateTime))-Number(new Date(e.createDateTime)):Number(new Date(e.createDateTime))-Number(new Date(l.createDateTime)))},c=(0,r.createContext)({}),o=e=>{let{children:t}=e,{articles:l,loading:n,setArticles:o}=a(),[u,d]=(0,r.useState)("newest"),[x,h]=(0,r.useState)([]),[m,f]=(0,r.useState)("");(0,r.useEffect)(()=>{l.length>0&&h(i(l))},[l]);let b=(0,r.useCallback)(e=>{let t=l.filter(t=>t.id!==e);o(t)},[l,o]),j=(0,r.useCallback)(e=>{o(t=>[...t,e])},[o]),p=(0,r.useCallback)((e,t)=>{let s=l.map(l=>(l.id===e&&(l.title=t.title,l.description=t.description),l));o(s)},[o,l]),w=(0,r.useCallback)(e=>{h([...l.filter(t=>t.title.toLowerCase().includes(e.toLowerCase()))])},[l,o]),v=(0,r.useCallback)(()=>{C()},[u,x]),C=(0,r.useCallback)(()=>"newest"===u?(d("oldest"),h(i(l,"oldest"))):(d("newest"),h(i(l,"newest"))),[u,x]);return(0,s.jsx)(c.Provider,{value:{articles:l,loading:n,deleteArticle:b,addArticle:j,updateArticle:p,searchArticle:w,searchString:m,setSearchString:f,storedArticles:x,setStoredArticles:h,sortArticleByDate:v},children:t})}},6230:function(e,t,l){"use strict";l.d(t,{n:function(){return a},t:function(){return n}});var s=l(7437),r=l(2265);let n=(0,r.createContext)({}),a=e=>{let{children:t}=e,[l,a]=(0,r.useState)(!1),[i,c]=(0,r.useState)("add"),[o,u]=(0,r.useState)({});return(0,s.jsx)(n.Provider,{value:{open:l,setOpen:a,handleOpen:()=>a(!0),handleClose:()=>a(!1),modalType:i,setModalType:c,inputs:o,setInputs:u},children:t})}},6450:function(e,t,l){"use strict";l.d(t,{r:function(){return s}});let s=async(e,t,l)=>{let s=localStorage.getItem("accessToken")?JSON.parse(localStorage.getItem("accessToken")):null,r=await fetch(e,{method:t,body:l&&JSON.stringify(l),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});return r.json()}}},function(e){e.O(0,[807,933,599,626,971,596,744],function(){return e(e.s=5379)}),_N_E=e.O()}]);